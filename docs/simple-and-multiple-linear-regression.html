<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Topic 4 Simple and multiple linear regression | Getting started with Quantitative Research Methods and R</title>
  <meta name="description" content="These are some of the course materials for the Goldsmiths’ Core Quantitative Research Methods course. It is a living document that will be added to regularly." />
  <meta name="generator" content="bookdown 0.18 and GitBook 2.6.7" />

  <meta property="og:title" content="Topic 4 Simple and multiple linear regression | Getting started with Quantitative Research Methods and R" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="These are some of the course materials for the Goldsmiths’ Core Quantitative Research Methods course. It is a living document that will be added to regularly." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Topic 4 Simple and multiple linear regression | Getting started with Quantitative Research Methods and R" />
  
  <meta name="twitter:description" content="These are some of the course materials for the Goldsmiths’ Core Quantitative Research Methods course. It is a living document that will be added to regularly." />
  

<meta name="author" content="Lukas Wallrich" />


<meta name="date" content="2020-03-21" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  <link rel="shortcut icon" href="favicon.ico" type="image/x-icon" />
<link rel="prev" href="data-visualisation.html"/>
<link rel="next" href="comparing-means-between-conditions-or-groups.html"/>
<script src="libs/header-attrs-2.1/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/kePrint-0.0.1/kePrint.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="include\psyteachr.css" type="text/css" />
<link rel="stylesheet" href="include\style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Getting started with Quantitative Research Methods and R</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Overview</a>
<ul>
<li class="chapter" data-level="0.1" data-path="index.html"><a href="index.html#further-sources"><i class="fa fa-check"></i><b>0.1</b> Further sources</a>
<ul>
<li class="chapter" data-level="0.1.1" data-path="index.html"><a href="index.html#free-online-books"><i class="fa fa-check"></i><b>0.1.1</b> Free online books</a></li>
<li class="chapter" data-level="0.1.2" data-path="index.html"><a href="index.html#paperlibrary-books"><i class="fa fa-check"></i><b>0.1.2</b> Paper/library books</a></li>
<li class="chapter" data-level="0.1.3" data-path="index.html"><a href="index.html#other-key-resources"><i class="fa fa-check"></i><b>0.1.3</b> Other key resources</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="1" data-path="getting-started-with-r.html"><a href="getting-started-with-r.html"><i class="fa fa-check"></i><b>1</b> Getting started with R</a>
<ul>
<li class="chapter" data-level="1.1" data-path="getting-started-with-r.html"><a href="getting-started-with-r.html#install-r-on-your-computer"><i class="fa fa-check"></i><b>1.1</b> Install R on your computer</a></li>
<li class="chapter" data-level="1.2" data-path="getting-started-with-r.html"><a href="getting-started-with-r.html#some-key-concepts"><i class="fa fa-check"></i><b>1.2</b> Some key concepts</a>
<ul>
<li class="chapter" data-level="1.2.1" data-path="getting-started-with-r.html"><a href="getting-started-with-r.html#r-rstudio-and-r-packages"><i class="fa fa-check"></i><b>1.2.1</b> R, RStudio and R packages</a></li>
<li class="chapter" data-level="1.2.2" data-path="getting-started-with-r.html"><a href="getting-started-with-r.html#data-and-variables-in-r"><i class="fa fa-check"></i><b>1.2.2</b> Data and variables in R</a></li>
<li class="chapter" data-level="1.2.3" data-path="getting-started-with-r.html"><a href="getting-started-with-r.html#functions-in-r"><i class="fa fa-check"></i><b>1.2.3</b> Functions in R</a></li>
<li class="chapter" data-level="1.2.4" data-path="getting-started-with-r.html"><a href="getting-started-with-r.html#key-r-packages"><i class="fa fa-check"></i><b>1.2.4</b> Key R packages</a></li>
<li class="chapter" data-level="1.2.5" data-path="getting-started-with-r.html"><a href="getting-started-with-r.html#rmarkdown"><i class="fa fa-check"></i><b>1.2.5</b> RMarkdown</a></li>
<li class="chapter" data-level="1.2.6" data-path="getting-started-with-r.html"><a href="getting-started-with-r.html#help-what-to-do-when-problems-appear"><i class="fa fa-check"></i><b>1.2.6</b> HELP! What to do when problems appear?</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="importing-and-describing-data.html"><a href="importing-and-describing-data.html"><i class="fa fa-check"></i><b>2</b> Importing and describing data</a>
<ul>
<li class="chapter" data-level="2.1" data-path="importing-and-describing-data.html"><a href="importing-and-describing-data.html#importing-data-into-r"><i class="fa fa-check"></i><b>2.1</b> Importing data into R</a></li>
<li class="chapter" data-level="2.2" data-path="importing-and-describing-data.html"><a href="importing-and-describing-data.html#manipulating-data"><i class="fa fa-check"></i><b>2.2</b> Manipulating data</a></li>
<li class="chapter" data-level="2.3" data-path="importing-and-describing-data.html"><a href="importing-and-describing-data.html#functions-to-view-and-summarise-data"><i class="fa fa-check"></i><b>2.3</b> Functions to view and summarise data</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="data-visualisation.html"><a href="data-visualisation.html"><i class="fa fa-check"></i><b>3</b> Data visualisation</a>
<ul>
<li class="chapter" data-level="3.1" data-path="data-visualisation.html"><a href="data-visualisation.html#ggplot2"><i class="fa fa-check"></i><b>3.1</b> ggplot2</a></li>
<li class="chapter" data-level="3.2" data-path="data-visualisation.html"><a href="data-visualisation.html#further-resources"><i class="fa fa-check"></i><b>3.2</b> Further resources</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="simple-and-multiple-linear-regression.html"><a href="simple-and-multiple-linear-regression.html"><i class="fa fa-check"></i><b>4</b> Simple and multiple linear regression</a>
<ul>
<li class="chapter" data-level="4.1" data-path="simple-and-multiple-linear-regression.html"><a href="simple-and-multiple-linear-regression.html#simple-linear-regression"><i class="fa fa-check"></i><b>4.1</b> Simple linear regression</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="simple-and-multiple-linear-regression.html"><a href="simple-and-multiple-linear-regression.html#plotting-a-simple-linear-regression-model"><i class="fa fa-check"></i><b>4.1.1</b> Plotting a simple linear regression model</a></li>
<li class="chapter" data-level="4.1.2" data-path="simple-and-multiple-linear-regression.html"><a href="simple-and-multiple-linear-regression.html#mathematical-representation-of-a-simple-linear-regression-model"><i class="fa fa-check"></i><b>4.1.2</b> Mathematical representation of a simple linear regression model</a></li>
<li class="chapter" data-level="4.1.3" data-path="simple-and-multiple-linear-regression.html"><a href="simple-and-multiple-linear-regression.html#fitting-a-simple-linear-regression-model-in-r"><i class="fa fa-check"></i><b>4.1.3</b> Fitting a simple linear regression model in R</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="simple-and-multiple-linear-regression.html"><a href="simple-and-multiple-linear-regression.html#bivariate-correlation"><i class="fa fa-check"></i><b>4.2</b> Bivariate correlation</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="simple-and-multiple-linear-regression.html"><a href="simple-and-multiple-linear-regression.html#calculating-the-correlation-coefficient"><i class="fa fa-check"></i><b>4.2.1</b> Calculating the correlation coefficient</a></li>
<li class="chapter" data-level="4.2.2" data-path="simple-and-multiple-linear-regression.html"><a href="simple-and-multiple-linear-regression.html#equivalence-to-linear-regression"><i class="fa fa-check"></i><b>4.2.2</b> Equivalence to linear regression</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="simple-and-multiple-linear-regression.html"><a href="simple-and-multiple-linear-regression.html#multiple-linear-regression"><i class="fa fa-check"></i><b>4.3</b> Multiple linear regression</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="simple-and-multiple-linear-regression.html"><a href="simple-and-multiple-linear-regression.html#dummy-coding-revisited"><i class="fa fa-check"></i><b>4.3.1</b> Dummy coding revisited</a></li>
<li class="chapter" data-level="4.3.2" data-path="simple-and-multiple-linear-regression.html"><a href="simple-and-multiple-linear-regression.html#mathematical-structure-of-multiple-linear-models"><i class="fa fa-check"></i><b>4.3.2</b> Mathematical structure of multiple linear models</a></li>
<li class="chapter" data-level="4.3.3" data-path="simple-and-multiple-linear-regression.html"><a href="simple-and-multiple-linear-regression.html#running-multiple-linear-regression-models-in-r"><i class="fa fa-check"></i><b>4.3.3</b> Running multiple linear regression models in R</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="comparing-means-between-conditions-or-groups.html"><a href="comparing-means-between-conditions-or-groups.html"><i class="fa fa-check"></i><b>5</b> Comparing means between conditions or groups</a>
<ul>
<li class="chapter" data-level="5.0.1" data-path="comparing-means-between-conditions-or-groups.html"><a href="comparing-means-between-conditions-or-groups.html#repeated-measures-or-independent-samples"><i class="fa fa-check"></i><b>5.0.1</b> Repeated measures or independent samples</a></li>
<li class="chapter" data-level="5.0.2" data-path="comparing-means-between-conditions-or-groups.html"><a href="comparing-means-between-conditions-or-groups.html#two-independent-means"><i class="fa fa-check"></i><b>5.0.2</b> Two independent means</a></li>
<li class="chapter" data-level="5.0.3" data-path="comparing-means-between-conditions-or-groups.html"><a href="comparing-means-between-conditions-or-groups.html#two-dependent-means"><i class="fa fa-check"></i><b>5.0.3</b> Two dependent means</a></li>
<li class="chapter" data-level="5.0.4" data-path="comparing-means-between-conditions-or-groups.html"><a href="comparing-means-between-conditions-or-groups.html#more-than-two-independent-means"><i class="fa fa-check"></i><b>5.0.4</b> More than two independent means</a></li>
<li class="chapter" data-level="5.0.5" data-path="comparing-means-between-conditions-or-groups.html"><a href="comparing-means-between-conditions-or-groups.html#more-than-two-means-from-repeated-measures"><i class="fa fa-check"></i><b>5.0.5</b> More than two means from repeated measures</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="interaction-terms-in-linear-models.html"><a href="interaction-terms-in-linear-models.html"><i class="fa fa-check"></i><b>6</b> Interaction terms in linear models</a>
<ul>
<li class="chapter" data-level="6.1" data-path="interaction-terms-in-linear-models.html"><a href="interaction-terms-in-linear-models.html#example-1-memory-and-chess"><i class="fa fa-check"></i><b>6.1</b> Example 1: Memory and chess</a></li>
<li class="chapter" data-level="6.2" data-path="interaction-terms-in-linear-models.html"><a href="interaction-terms-in-linear-models.html#example-2-link-between-obesity-and-negative-emotions-in-the-european-social-survey"><i class="fa fa-check"></i><b>6.2</b> Example 2: link between obesity and negative emotions in the European Social Survey</a></li>
<li class="chapter" data-level="6.3" data-path="interaction-terms-in-linear-models.html"><a href="interaction-terms-in-linear-models.html#example-3-link-between-working-hours-income-and-life-satisfaction"><i class="fa fa-check"></i><b>6.3</b> Example 3: link between working hours, income and life satisfaction</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="chi-squared-tests-for-associations-between-categorical-variables.html"><a href="chi-squared-tests-for-associations-between-categorical-variables.html"><i class="fa fa-check"></i><b>7</b> Chi-squared tests for associations between categorical variables</a>
<ul>
<li class="chapter" data-level="7.1" data-path="chi-squared-tests-for-associations-between-categorical-variables.html"><a href="chi-squared-tests-for-associations-between-categorical-variables.html#tables-of-frequencies-and-proportions"><i class="fa fa-check"></i><b>7.1</b> Tables of frequencies and proportions</a></li>
<li class="chapter" data-level="7.2" data-path="chi-squared-tests-for-associations-between-categorical-variables.html"><a href="chi-squared-tests-for-associations-between-categorical-variables.html#the-null-hypothesis-and-the-chi2-statistic"><i class="fa fa-check"></i><b>7.2</b> The null hypothesis and the <span class="math inline">\(\chi^2\)</span> statistic</a></li>
<li class="chapter" data-level="7.3" data-path="chi-squared-tests-for-associations-between-categorical-variables.html"><a href="chi-squared-tests-for-associations-between-categorical-variables.html#the-chisq.test-function"><i class="fa fa-check"></i><b>7.3</b> The chisq.test() function</a>
<ul>
<li class="chapter" data-level="7.3.1" data-path="chi-squared-tests-for-associations-between-categorical-variables.html"><a href="chi-squared-tests-for-associations-between-categorical-variables.html#dealing-with-small-samples"><i class="fa fa-check"></i><b>7.3.1</b> Dealing with small samples</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="chi-squared-tests-for-associations-between-categorical-variables.html"><a href="chi-squared-tests-for-associations-between-categorical-variables.html#post-hoc-tests"><i class="fa fa-check"></i><b>7.4</b> Post-hoc tests</a></li>
<li class="chapter" data-level="7.5" data-path="chi-squared-tests-for-associations-between-categorical-variables.html"><a href="chi-squared-tests-for-associations-between-categorical-variables.html#effect-sizes"><i class="fa fa-check"></i><b>7.5</b> Effect sizes</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="reporting-the-results-of-statistical-tests.html"><a href="reporting-the-results-of-statistical-tests.html"><i class="fa fa-check"></i><b>8</b> Reporting the results of statistical tests</a>
<ul>
<li class="chapter" data-level="8.1" data-path="reporting-the-results-of-statistical-tests.html"><a href="reporting-the-results-of-statistical-tests.html#essential-pieces-of-information"><i class="fa fa-check"></i><b>8.1</b> Essential pieces of information</a>
<ul>
<li class="chapter" data-level="8.1.1" data-path="reporting-the-results-of-statistical-tests.html"><a href="reporting-the-results-of-statistical-tests.html#what-to-include-for-specific-tests"><i class="fa fa-check"></i><b>8.1.1</b> What to include for specific tests</a></li>
<li class="chapter" data-level="8.1.2" data-path="reporting-the-results-of-statistical-tests.html"><a href="reporting-the-results-of-statistical-tests.html#formatting"><i class="fa fa-check"></i><b>8.1.2</b> Formatting</a></li>
<li class="chapter" data-level="8.1.3" data-path="reporting-the-results-of-statistical-tests.html"><a href="reporting-the-results-of-statistical-tests.html#rounding"><i class="fa fa-check"></i><b>8.1.3</b> Rounding</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="accessing-online-data-sources.html"><a href="accessing-online-data-sources.html"><i class="fa fa-check"></i><b>9</b> Accessing online data sources</a>
<ul>
<li class="chapter" data-level="9.1" data-path="accessing-online-data-sources.html"><a href="accessing-online-data-sources.html#world-bank-data"><i class="fa fa-check"></i><b>9.1</b> World Bank data</a></li>
<li class="chapter" data-level="9.2" data-path="accessing-online-data-sources.html"><a href="accessing-online-data-sources.html#wikidata"><i class="fa fa-check"></i><b>9.2</b> Wikidata</a></li>
<li class="chapter" data-level="9.3" data-path="accessing-online-data-sources.html"><a href="accessing-online-data-sources.html#other-data-sources"><i class="fa fa-check"></i><b>9.3</b> Other data sources</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="dealing-with-missing-data.html"><a href="dealing-with-missing-data.html"><i class="fa fa-check"></i><b>10</b> Dealing with missing data</a>
<ul>
<li class="chapter" data-level="10.1" data-path="dealing-with-missing-data.html"><a href="dealing-with-missing-data.html#example"><i class="fa fa-check"></i><b>10.1</b> Example</a>
<ul>
<li class="chapter" data-level="10.1.1" data-path="dealing-with-missing-data.html"><a href="dealing-with-missing-data.html#case-deletion"><i class="fa fa-check"></i><b>10.1.1</b> Case deletion</a></li>
<li class="chapter" data-level="10.1.2" data-path="dealing-with-missing-data.html"><a href="dealing-with-missing-data.html#imputation"><i class="fa fa-check"></i><b>10.1.2</b> Imputation</a></li>
</ul></li>
<li class="chapter" data-level="10.2" data-path="dealing-with-missing-data.html"><a href="dealing-with-missing-data.html#further-resources-1"><i class="fa fa-check"></i><b>10.2</b> Further resources</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="probability-in-statistics-and-real-life.html"><a href="probability-in-statistics-and-real-life.html"><i class="fa fa-check"></i><b>11</b> Probability in statistics and real life</a>
<ul>
<li class="chapter" data-level="11.1" data-path="probability-in-statistics-and-real-life.html"><a href="probability-in-statistics-and-real-life.html#what-are-probabilities"><i class="fa fa-check"></i><b>11.1</b> What are probabilities?</a></li>
<li class="chapter" data-level="11.2" data-path="probability-in-statistics-and-real-life.html"><a href="probability-in-statistics-and-real-life.html#combining-multiple-events-together"><i class="fa fa-check"></i><b>11.2</b> Combining multiple events together</a></li>
<li class="chapter" data-level="11.3" data-path="probability-in-statistics-and-real-life.html"><a href="probability-in-statistics-and-real-life.html#looking-at-independent-events"><i class="fa fa-check"></i><b>11.3</b> Looking at independent events</a></li>
<li class="chapter" data-level="11.4" data-path="probability-in-statistics-and-real-life.html"><a href="probability-in-statistics-and-real-life.html#updating-our-beliefs---bayes-theorem"><i class="fa fa-check"></i><b>11.4</b> Updating our beliefs - Bayes’ theorem</a></li>
<li class="chapter" data-level="11.5" data-path="probability-in-statistics-and-real-life.html"><a href="probability-in-statistics-and-real-life.html#further-resources-2"><i class="fa fa-check"></i><b>11.5</b> Further resources</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="packages-and-references.html"><a href="packages-and-references.html"><i class="fa fa-check"></i><b>12</b> Packages and references</a></li>
<li class="appendix"><span><b>Appendices</b></span></li>
<li class="chapter" data-level="A" data-path="two-more-pipes.html"><a href="two-more-pipes.html"><i class="fa fa-check"></i><b>A</b> Two more pipes</a>
<ul>
<li class="chapter" data-level="A.1" data-path="two-more-pipes.html"><a href="two-more-pipes.html#expanding-the-tidyverse-the-exposition-pipe"><i class="fa fa-check"></i><b>A.1</b> Expanding the tidyverse: the exposition pipe (<code>%$%</code>)</a></li>
<li class="chapter" data-level="A.2" data-path="two-more-pipes.html"><a href="two-more-pipes.html#a-somewhat-risky-time-saver-the-assignment-pipe"><i class="fa fa-check"></i><b>A.2</b> A somewhat risky time-saver: the assignment pipe (<code>%&lt;&gt;%</code>)</a></li>
</ul></li>
<li class="divider"></li>
<li><a rel="license" href="https://creativecommons.org/licenses/by-sa/4.0/" 
    target="blank"><img alt="Creative Commons License" 
    style="border-width:0" 
    src="https://i.creativecommons.org/l/by-sa/4.0/88x31.png" /></a><li>
<li><a href="https://psyteachr.github.io/" target="blank">PsyTeachR</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Getting started with Quantitative Research Methods and R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="simple-and-multiple-linear-regression" class="section level1" number="4">
<h1><span class="header-section-number">Topic 4</span> Simple and multiple linear regression</h1>
<p>This document recaps how we assess relationships between variables. It is work in progress and will be updated as we explore some further tests and special cases in the weeks to come.</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="simple-and-multiple-linear-regression.html#cb21-1"></a><span class="kw">library</span>(tidyverse)</span></code></pre></div>
<div id="simple-linear-regression" class="section level2" number="4.1">
<h2><span class="header-section-number">4.1</span> Simple linear regression</h2>
<p>For an introduction to simple linear regression and correlation, watch this video:
<iframe src=" https://www.youtube.com/embed/uoMjSFApBTY?rel=0 " allowfullscreen width=80% height=350></iframe></p>
<p>When considering the relationship between two continuous variables, we should always start with a scatterplot - for example, of the relationship between social trust and life satisfaction at the national level in European countries (data from the European Social Survey 2014).</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="simple-and-multiple-linear-regression.html#cb22-1"></a><span class="co">#Data preparation</span></span>
<span id="cb22-2"><a href="simple-and-multiple-linear-regression.html#cb22-2"></a>ess &lt;-<span class="st"> </span><span class="kw">read_rds</span>(<span class="kw">url</span>(<span class="st">&quot;http://empower-training.de/Gold/round7.RDS&quot;</span>))</span>
<span id="cb22-3"><a href="simple-and-multiple-linear-regression.html#cb22-3"></a>ess &lt;-<span class="st"> </span>ess <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="dt">soctrust =</span> (ppltrst <span class="op">+</span><span class="st"> </span>pplfair <span class="op">+</span><span class="st"> </span>pplhlp)<span class="op">/</span><span class="dv">3</span>)</span>
<span id="cb22-4"><a href="simple-and-multiple-linear-regression.html#cb22-4"></a>nat_avgs &lt;-<span class="st"> </span>ess <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">group_by</span>(cntry) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb22-5"><a href="simple-and-multiple-linear-regression.html#cb22-5"></a><span class="st">  </span><span class="kw">summarize</span>(<span class="dt">nat_soctrust =</span> <span class="kw">mean</span>(soctrust, <span class="dt">na.rm=</span>T), </span>
<span id="cb22-6"><a href="simple-and-multiple-linear-regression.html#cb22-6"></a>            <span class="dt">nat_stflife =</span> <span class="kw">mean</span>(stflife, <span class="dt">na.rm=</span>T))</span>
<span id="cb22-7"><a href="simple-and-multiple-linear-regression.html#cb22-7"></a></span>
<span id="cb22-8"><a href="simple-and-multiple-linear-regression.html#cb22-8"></a><span class="kw">ggplot</span>(nat_avgs, <span class="kw">aes</span>(<span class="dt">x=</span>nat_soctrust, <span class="dt">y=</span>nat_stflife)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_point</span>()</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-2"></span>
<img src="05-linear-regression_files/figure-html/unnamed-chunk-2-1.png" alt="**CAPTION THIS FIGURE!!**" width="100%" />
<p class="caption">
Figure 4.1: <strong>CAPTION THIS FIGURE!!</strong>
</p>
</div>
<p>The scatterplot can now help us to think about what kind of model would help us to explain or predict one variable based on the other. If a straight-line relationship seems reasonable, we can use a linear model.</p>
<div id="plotting-a-simple-linear-regression-model" class="section level3" number="4.1.1">
<h3><span class="header-section-number">4.1.1</span> Plotting a simple linear regression model</h3>
<p>Geometrically, a simple linear regression model is just a straight line through the scatterplot, fitted in a way that minimises the distances from the points to the line. It can be fitted with the <code>geom_smooth(method="lm")</code> function.</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="simple-and-multiple-linear-regression.html#cb23-1"></a><span class="kw">ggplot</span>(nat_avgs, <span class="kw">aes</span>(<span class="dt">x=</span>nat_soctrust, <span class="dt">y=</span>nat_stflife)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb23-2"><a href="simple-and-multiple-linear-regression.html#cb23-2"></a><span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span><span class="st"> </span><span class="kw">geom_smooth</span>(<span class="dt">method=</span><span class="st">&quot;lm&quot;</span>, <span class="dt">se=</span><span class="ot">FALSE</span>) </span></code></pre></div>
<pre><code>## `geom_smooth()` using formula &#39;y ~ x&#39;</code></pre>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-3"></span>
<img src="05-linear-regression_files/figure-html/unnamed-chunk-3-1.png" alt="**CAPTION THIS FIGURE!!**" width="100%" />
<p class="caption">
Figure 4.2: <strong>CAPTION THIS FIGURE!!</strong>
</p>
</div>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="simple-and-multiple-linear-regression.html#cb25-1"></a>    <span class="co">#se=FALSE hides confidence bands that are often just visual clutter</span></span></code></pre></div>
<p>For each value of one variable, this line now allows us to find the corresponding expected value of the other variable.</p>
</div>
<div id="mathematical-representation-of-a-simple-linear-regression-model" class="section level3" number="4.1.2">
<h3><span class="header-section-number">4.1.2</span> Mathematical representation of a simple linear regression model</h3>
<p>The idea of a simple linear regression model is to link one predictor variable, <span class="math inline">\(x\)</span>, to an outcome variable, <span class="math inline">\(y\)</span>. Their relationship can be expressed in a simple formula:
<span class="math display">\[y=\beta_{0} +  \beta_{1}*x\]</span>
Here, <strong><span class="math inline">\(\beta_{1}\)</span> is the most important parameter</strong> - it tells us, how much a change of 1 in the <span class="math inline">\(x\)</span>-variable affects the <span class="math inline">\(y\)</span>-variable. Geometrically, it is the slope of the regression line. <span class="math inline">\(\beta_{0}\)</span> is the intercept of that line, i.e. the value of <span class="math inline">\(y\)</span> when <span class="math inline">\(x\)</span> is 0 - since <span class="math inline">\(x\)</span> can often not be zero, that parameter tends to be of little interest on its own.</p>
</div>
<div id="fitting-a-simple-linear-regression-model-in-r" class="section level3" number="4.1.3">
<h3><span class="header-section-number">4.1.3</span> Fitting a simple linear regression model in R</h3>
<p>Linear models are fitted in R using the <code>lm()</code> function. The model itself is specified as a formula with the notation <code>y ~ x</code> where the <code>~</code> means ‘is predicted by’ and the intercept is added automatically.</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="simple-and-multiple-linear-regression.html#cb26-1"></a><span class="kw">lm</span>(nat_stflife <span class="op">~</span><span class="st"> </span>nat_soctrust, <span class="dt">data =</span> nat_avgs) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">summary</span>()</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = nat_stflife ~ nat_soctrust, data = nat_avgs)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -0.86854 -0.35172  0.00667  0.30745  0.85047 
## 
## Coefficients:
##              Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)    2.7767     0.7311   3.798  0.00122 ** 
## nat_soctrust   0.8025     0.1347   5.957 9.84e-06 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.4633 on 19 degrees of freedom
## Multiple R-squared:  0.6513, Adjusted R-squared:  0.6329 
## F-statistic: 35.49 on 1 and 19 DF,  p-value: 9.839e-06</code></pre>
<p>In the summary, the first column of the coefficients table gives the estimates for
<span class="math inline">\(\beta_{0}\)</span> (in the intercept row) and <span class="math inline">\(\beta_{1}\)</span> (in the nat_soctrust row). Thus in this case, the regression formula could be written as:</p>
<p><span class="math display">\[LifeSatisfaction = 2.76 +  0.80 * SocialTrust\]</span>
Clearly this formula does not allow us to perfectly predict one variable from the other; we have already seen in the graph that not all points fall exactly on the line. The distances between each point and the line are the <strong>residuals</strong> - their distribution is described at the top of the <code>summary()</code>-function output.</p>
<div id="interpreting-r2" class="section level4" number="4.1.3.1">
<h4><span class="header-section-number">4.1.3.1</span> Interpreting <span class="math inline">\(R^2\)</span></h4>
<p>The model output allows us to say how well the line fits by considering the <span class="math inline">\(R^2\)</span> value. It is based on the sum of the squares of the deviations of each data point from either the mean (<span class="math inline">\(SS_{total}\)</span>) or the model(<span class="math inline">\(SS_{residual}\)</span>).</p>
<p>If I was considering a model that predicted people’s height, I might have a person who is 1.6m tall. If the mean of the data was 1.8m, their squared total deviation would be <span class="math inline">\(0.2*0.2 = 0.04\)</span>. If the model then predicted their height at 1.55m, their squared residual deviation would be <span class="math inline">\(-0.05*-0.05 = 0.025\)</span>. Once this is summed up for all data points, <span class="math inline">\(R^2\)</span> is calculated with the following formula:
<span class="math display">\[R^2 = 1 - \frac{SS_{residual}}{SS_{total}}\]</span></p>
<p>Given that the sum of squared residuals can never be less than 0 or more than the sum of the total residuals, <span class="math inline">\(R^2\)</span> can only take up values between 0 and 1. It can be understood as the share of total variance explained by the model (or to link it to the formula: as the total variance minus the share <em>not</em> explained by the model).</p>
</div>
<div id="interpreting-prt-the-p-value" class="section level4" number="4.1.3.2">
<h4><span class="header-section-number">4.1.3.2</span> Interpreting Pr(&gt;|t|), the <em>p</em>-value</h4>
<p>Each coefficient comes with an associated <em>p</em>-value in the summary that is shown at the end of the row. As indicated by the column title, it indicates the probability that the test statistic would be this large or larger <em>if</em> the null hypothesis was true and there was no association in the underlying population.</p>
<p>As per usual, we would typically report coefficients with a <em>p</em>-value below .05 as statistically significant. The significance level for the intercept is almost never relevant and thus not reported (it simply tests whether the value of y would be different from 0 when x is zero, which is rarely of particular interest).</p>
</div>
</div>
</div>
<div id="bivariate-correlation" class="section level2" number="4.2">
<h2><span class="header-section-number">4.2</span> Bivariate correlation</h2>
<p>Simple linear regression can tell us whether two variables are linearly related to each other, whether this finding is statistically significant (i.e. unlikely to have arisen due to change), and how strong the relationship is <em>in terms of the units of the two variables.</em> Quite often, however, we would prefer a standardised measure of the strength of a relationship, and a quicker test. That is where correlation comes in.</p>
<p>The <strong>Pearson’s correlation coefficient</strong> is the slope of the regression line when both variables are standardised, i.e. expressed in units of their standard deviations (as so-called Z-scores). It is again bounded, between -1 and 1, and as it is unit-free, it can give quick information as to which relationships matter more and which matter less.</p>
<div id="calculating-the-correlation-coefficient" class="section level3" number="4.2.1">
<h3><span class="header-section-number">4.2.1</span> Calculating the correlation coefficient</h3>
<p>Before calculating a correlation coefficient, <strong>you need to look at the scatterplot and make sure that a straight-line relationship looks reasonable.</strong> If that is the case, you can use the <code>cor.test()</code> function to calculate the correlation coefficient.</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="simple-and-multiple-linear-regression.html#cb28-1"></a><span class="kw">cor.test</span>(nat_avgs<span class="op">$</span>nat_soctrust, nat_avgs<span class="op">$</span>nat_stflife) </span>
<span id="cb28-2"><a href="simple-and-multiple-linear-regression.html#cb28-2"></a><span class="co">#If you have missing data, use the na.rm = TRUE argument to have it excluded before the calculation</span></span></code></pre></div>
<pre><code>## 
##  Pearson&#39;s product-moment correlation
## 
## data:  nat_avgs$nat_soctrust and nat_avgs$nat_stflife
## t = 5.957, df = 19, p-value = 9.839e-06
## alternative hypothesis: true correlation is not equal to 0
## 95 percent confidence interval:
##  0.5760041 0.9186640
## sample estimates:
##       cor 
## 0.8070221</code></pre>
<p>The estimated cor at the very bottom is the correlation coefficient, usually reported as <em>r</em> = .81. This shows that there is a strong positive relationship between the two variables. Check the <em>p</em>-value to see whether the relationship is statistically significant and the 95%-confidence interval to see how precise the estimate is likely to be.</p>
</div>
<div id="equivalence-to-linear-regression" class="section level3" number="4.2.2">
<h3><span class="header-section-number">4.2.2</span> Equivalence to linear regression</h3>
<p>Just to show that this is indeed equivalent to simple linear regression on the standardised variables, which can be calculated using the <code>scale()</code>-function.</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="simple-and-multiple-linear-regression.html#cb30-1"></a><span class="kw">ggplot</span>(nat_avgs, <span class="kw">aes</span>(<span class="dt">x=</span><span class="kw">scale</span>(nat_soctrust), <span class="dt">y=</span><span class="kw">scale</span>(nat_stflife))) <span class="op">+</span><span class="st"> </span></span>
<span id="cb30-2"><a href="simple-and-multiple-linear-regression.html#cb30-2"></a><span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span><span class="st"> </span><span class="kw">geom_smooth</span>(<span class="dt">method=</span><span class="st">&quot;lm&quot;</span>, <span class="dt">se=</span><span class="ot">FALSE</span>)</span></code></pre></div>
<pre><code>## `geom_smooth()` using formula &#39;y ~ x&#39;</code></pre>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-6"></span>
<img src="05-linear-regression_files/figure-html/unnamed-chunk-6-1.png" alt="**CAPTION THIS FIGURE!!**" width="100%" />
<p class="caption">
Figure 4.3: <strong>CAPTION THIS FIGURE!!</strong>
</p>
</div>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="simple-and-multiple-linear-regression.html#cb32-1"></a><span class="kw">lm</span>(<span class="kw">scale</span>(nat_stflife) <span class="op">~</span><span class="st"> </span><span class="kw">scale</span>(nat_soctrust), <span class="dt">data =</span> nat_avgs) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">summary</span>()</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = scale(nat_stflife) ~ scale(nat_soctrust), data = nat_avgs)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -1.13572 -0.45992  0.00872  0.40203  1.11209 
## 
## Coefficients:
##                      Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)         1.524e-16  1.322e-01   0.000        1    
## scale(nat_soctrust) 8.070e-01  1.355e-01   5.957 9.84e-06 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.6059 on 19 degrees of freedom
## Multiple R-squared:  0.6513, Adjusted R-squared:  0.6329 
## F-statistic: 35.49 on 1 and 19 DF,  p-value: 9.839e-06</code></pre>
<p>Note that the regression coefficient for the scaled variable is now exactly identical to the correlation coefficient shown above.</p>
</div>
</div>
<div id="multiple-linear-regression" class="section level2" number="4.3">
<h2><span class="header-section-number">4.3</span> Multiple linear regression</h2>
<p>Linear models can easily be extended to multiple predictor variables. Here I will focus on a few key points that particularly focus on linear models that include categorical predictor variables.</p>
<p>You can watch this video to take you through the process of extending simple linear regression to include multiple variables step-by-step:</p>
<iframe src=" https://www.youtube.com/embed/6lcDzTlsGVE?rel=0 " allowfullscreen width="80%" height="350">
</iframe>
<div id="dummy-coding-revisited" class="section level3" number="4.3.1">
<h3><span class="header-section-number">4.3.1</span> Dummy coding revisited</h3>
<p>Multiple linear regression models often use categorical predictors. However, they need to be turned into numbers. This is done through automatic dummy coding, which creates variables coded as 0 and 1.</p>
<p>Note that dummy coding always results in <strong>one fewer dummy variable than the number of levels of the categorical variable</strong>. For example, a gender variable with two levels (male/female) would be recoded into a single dummy variable <em>female</em> (0=no, 1=yes). Note that there is no equivalent variable <em>male</em> as that would be redundant. Given that the hypothetical gender variable here is defined as either male or female, not female necessarily implies male.</p>
<p>The same applies to larger number of levels - see how three possible values for the department variabel can be recoded into two dummy variables:
<img src="W10Dummy.png" alt="Dummy coding example" /></p>
<p>The level that is not explicitly mentioned anymore is the <strong>reference level</strong>. In a linear model, that is what all other effects are compared to, so it is important to keep in mind which that is.</p>
</div>
<div id="mathematical-structure-of-multiple-linear-models" class="section level3" number="4.3.2">
<h3><span class="header-section-number">4.3.2</span> Mathematical structure of multiple linear models</h3>
<p>Linear models are characterised by intercepts and slopes. Geometrically, intercepts shift a line or plane along an axis, while a slope changes its orientation in space. Conceptually, intercepts are like on/off switches, while slopes indicate what happens when variables are dialed up or down.</p>
<p>For example, we might want to predict life expectancy based on a person’s gender and their level of physical activity. Then the model would be</p>
<p><span class="math display">\[LifeExpectancy=\beta_{0} +  \beta_{1}*female + \beta_{2}*activity\]</span>
<span class="math inline">\(\beta_{0}\)</span> here would describe the notional life expectancy of males without any activity, <span class="math inline">\(\beta_{0}+\beta_{1}\)</span> would describe that of females without any exercise - so both of these are intercepts, the <span class="math inline">\(female\)</span> variable simply determines which intercept we choose. <span class="math inline">\(\beta_{2}\)</span> is now the effect of each unit of activity, i.e. the slope of the regression line.</p>
</div>
<div id="running-multiple-linear-regression-models-in-r" class="section level3" number="4.3.3">
<h3><span class="header-section-number">4.3.3</span> Running multiple linear regression models in R</h3>
<p>In the <code>lm()</code>-function, it is very easy to keep on adding predictors to the formula by just using the <code>+</code>-symbol. For example, we can consider the UK General Election Results in 2019 and see what helps explain the vote share of the Conservatives.</p>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="simple-and-multiple-linear-regression.html#cb34-1"></a><span class="co">#Load and prep data</span></span>
<span id="cb34-2"><a href="simple-and-multiple-linear-regression.html#cb34-2"></a>constituencies &lt;-<span class="st"> </span><span class="kw">read_csv</span>(<span class="kw">url</span>(<span class="st">&quot;http://empower-training.de/Gold/ConstituencyData2019.csv&quot;</span>), <span class="dt">col_types =</span> <span class="st">&quot;_cfddddfffddddfffdfdddd&quot;</span>)</span></code></pre></div>
<pre><code>## Warning: 168 parsing failures.
## row                    col expected actual         file
##  47 ConShare2017           a double   #N/A &lt;connection&gt;
## 534 ConShare2017           a double   #N/A &lt;connection&gt;
## 534 ShareReligious         a double   #N/A &lt;connection&gt;
## 534 ShareChristian         a double   #N/A &lt;connection&gt;
## 534 DeprivationRankEngland a double   #N/A &lt;connection&gt;
## ... ...................... ........ ...... ............
## See problems(...) for more details.</code></pre>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="simple-and-multiple-linear-regression.html#cb36-1"></a>constituencies &lt;-<span class="st"> </span>constituencies <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(RegionName <span class="op">!=</span><span class="st"> &quot;Northern Ireland&quot;</span>) <span class="op">%&gt;%</span></span>
<span id="cb36-2"><a href="simple-and-multiple-linear-regression.html#cb36-2"></a><span class="st">          </span><span class="kw">mutate</span>(<span class="dt">nation =</span> <span class="kw">case_when</span>(RegionName <span class="op">==</span><span class="st"> &quot;Scotland&quot;</span> <span class="op">~</span><span class="st"> &quot;Scotland&quot;</span>,</span>
<span id="cb36-3"><a href="simple-and-multiple-linear-regression.html#cb36-3"></a>                                    RegionName <span class="op">==</span><span class="st"> &quot;Wales&quot;</span> <span class="op">~</span><span class="st"> &quot;Wales&quot;</span>,</span>
<span id="cb36-4"><a href="simple-and-multiple-linear-regression.html#cb36-4"></a>                                    T <span class="op">~</span><span class="st"> &quot;England&quot;</span>))  <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb36-5"><a href="simple-and-multiple-linear-regression.html#cb36-5"></a><span class="st">          </span><span class="kw">filter</span>(ConstituencyName <span class="op">!=</span><span class="st"> &quot;Chorley&quot;</span>)</span>
<span id="cb36-6"><a href="simple-and-multiple-linear-regression.html#cb36-6"></a></span>
<span id="cb36-7"><a href="simple-and-multiple-linear-regression.html#cb36-7"></a><span class="co">#Simple linear regression model:</span></span>
<span id="cb36-8"><a href="simple-and-multiple-linear-regression.html#cb36-8"></a><span class="kw">lm</span>(ElectionConShare <span class="op">~</span><span class="st"> </span>MedianAge, <span class="dt">data =</span> constituencies) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">summary</span>()</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = ElectionConShare ~ MedianAge, data = constituencies)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -0.41131 -0.09130  0.01502  0.10007  0.30207 
## 
## Coefficients:
##              Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) -0.252020   0.040956  -6.153 1.35e-09 ***
## MedianAge    0.017104   0.001003  17.054  &lt; 2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.1384 on 629 degrees of freedom
## Multiple R-squared:  0.3162, Adjusted R-squared:  0.3151 
## F-statistic: 290.8 on 1 and 629 DF,  p-value: &lt; 2.2e-16</code></pre>
<p>We now know that the Conservative vote share seems to be strongly related to the median age of the constituency, and can find and interpret the coefficient estimate (1.7 pct-points per year of median age), significance value and <span class="math inline">\(R^2\)</span> as above. What happens when we add nation, to account for differences between Scotland, England and Wales?</p>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="simple-and-multiple-linear-regression.html#cb38-1"></a><span class="co">#Declare nation as factor and then set the reference level for categorical predictors</span></span>
<span id="cb38-2"><a href="simple-and-multiple-linear-regression.html#cb38-2"></a>constituencies<span class="op">$</span>nation &lt;-<span class="st"> </span><span class="kw">factor</span>(constituencies<span class="op">$</span>nation) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">relevel</span>(<span class="dt">ref =</span> <span class="st">&quot;England&quot;</span>)</span>
<span id="cb38-3"><a href="simple-and-multiple-linear-regression.html#cb38-3"></a><span class="kw">lm</span>(ElectionConShare <span class="op">~</span><span class="st"> </span>MedianAge <span class="op">+</span><span class="st"> </span>nation, <span class="dt">data =</span> constituencies) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">summary</span>()</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = ElectionConShare ~ MedianAge + nation, data = constituencies)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -0.37287 -0.06969  0.00687  0.07799  0.27545 
## 
## Coefficients:
##                  Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)    -0.2777133  0.0337157  -8.237 1.03e-15 ***
## MedianAge       0.0185574  0.0008295  22.373  &lt; 2e-16 ***
## nationScotland -0.2527752  0.0156649 -16.136  &lt; 2e-16 ***
## nationWales    -0.1493447  0.0187193  -7.978 7.08e-15 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.1138 on 627 degrees of freedom
## Multiple R-squared:  0.5392, Adjusted R-squared:  0.537 
## F-statistic: 244.6 on 3 and 627 DF,  p-value: &lt; 2.2e-16</code></pre>
<p>Now we have a more complex model. Based on the coefficient estimates, we would now estimate the vote share as follows
<span class="math display">\[VoteShare=-0.27 +  0.018*age + -0.25*Scotland + -0.15*Wales\]</span>
The figures for Scotland and Wales need to be compared to the unnamed reference level, i.e. to England - so we would expect a Scottish constituency to have a 25 percentage points lower Conservative vote share <em>when keeping median age constant.</em> Likewise, we now would expect an increase of the median age by 1 year to increase the Conservative vote share by 1.8 percentage points, <em>keeping the effect of nation constant.</em></p>
<div id="significance-testing-and-reporting-in-multiple-regression-models" class="section level4" number="4.3.3.1">
<h4><span class="header-section-number">4.3.3.1</span> Significance testing and reporting in multiple regression models</h4>
<p>With more than one predictor, we have two questions:</p>
<ul>
<li>is the <strong>overall model</strong> significant, i.e. can we confidently believe that its estimates are better than if we just took the overall mean as our estimate for each constituency? That is shown in the last line of the summary. Here we would report that the regression model predicting the conservative vote share per constituency based on its median age and the nation it was located in was significant, with <em>F</em>(3, 627) = 244.6, <em>p</em> &lt; .001, and explained a substantial share of the variance, <span class="math inline">\(R^2\)</span> = .54.</li>
<li>does <strong>each predictor</strong> explain a significant share of unique variance? That is shown at the end of each line in the coefficients table, with many predictors it would usually be reported in a table.</li>
</ul>

</div>
</div>
</div>
</div>
<div class="psyteachr_footer">
  
</div>
<script>

/* update total correct if #total_correct exists */
update_total_correct = function() {
  if (t = document.getElementById("total_correct")) {
    t.innerHTML =
      document.getElementsByClassName("correct").length + " of " +
      document.getElementsByClassName("solveme").length + " correct";
  }
}

/* solution button toggling function */
b_func = function() {
  var cl = this.parentElement.classList;
  if (cl.contains('open')) {
    cl.remove("open");
  } else {
    cl.add("open");
  }
}

/* function for checking solveme answers */
solveme_func = function(e) {
  var real_answers = JSON.parse(this.dataset.answer);
  var my_answer = this.value;
  var cl = this.classList;
  if (cl.contains("ignorecase")) {
    my_answer = my_answer.toLowerCase();
  }
  if (cl.contains("nospaces")) {
    my_answer = my_answer.replace(/ /g, "");
  }
  
  if (my_answer !== "" & real_answers.includes(my_answer)) {
    cl.add("correct");
  } else {
    cl.remove("correct");
  }

  // match numeric answers within a specified tolerance
  if(this.dataset.tol){
    var tol = JSON.parse(this.dataset.tol);  
    var matches = real_answers.map(x => Math.abs(x - my_answer) < tol)
    if (matches.reduce((a, b) => a + b, 0) > 0) {
      cl.add("correct");
    } else {
      cl.remove("correct");
    }  
  }

  // added regex bit
  if (cl.contains("regex")){
    answer_regex = RegExp(real_answers.join("|"))
    if (answer_regex.test(my_answer)) {
      cl.add("correct");
    }  
  }
  
  update_total_correct();
}

window.onload = function() {
  /* set up solution buttons */
  var buttons = document.getElementsByTagName("button");

  for (var i = 0; i < buttons.length; i++) {
    if (buttons[i].parentElement.classList.contains('solution')) {
      buttons[i].onclick = b_func;
    }
  }
  
  /* set up solveme inputs */
  var solveme = document.getElementsByClassName("solveme");

  for (var i = 0; i < solveme.length; i++) {
    /* make sure input boxes don't auto-anything */
    solveme[i].setAttribute("autocomplete","off");
    solveme[i].setAttribute("autocorrect", "off");
    solveme[i].setAttribute("autocapitalize", "off"); 
    solveme[i].setAttribute("spellcheck", "false");
    solveme[i].value = "";
    
    /* adjust answer for ignorecase or nospaces */
    var cl = solveme[i].classList;
    var real_answer = solveme[i].dataset.answer;
    if (cl.contains("ignorecase")) {
      real_answer = real_answer.toLowerCase();
    }
    if (cl.contains("nospaces")) {
      real_answer = real_answer.replace(/ /g, "");
    }
    solveme[i].dataset.answer = real_answer;
    
    /* attach checking function */
    solveme[i].onkeyup = solveme_func;
    solveme[i].onchange = solveme_func;
  }
  
  update_total_correct();
}

</script>
            </section>

          </div>
        </div>
      </div>
<a href="data-visualisation.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="comparing-means-between-conditions-or-groups.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"],
"google": false
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": {},
"toc": {
"collapse": "section",
"scroll_highlight": true
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
